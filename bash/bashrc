# .bashrc

# Source global definitions
if [ -f /etc/bashrc ]; then
	. /etc/bashrc
fi

##
# Aliases
alias v="vim"
alias mkdir="mkdir -pv" # make parent directories when creating subdirectory
alias listen="lsof -P -g -n" # list apps connected to network
alias ls="ls --color=auto --classify" # more descriptive list
alias rm="rm -i" # ask when deleting something
alias vim="gvim -v" # use terminal version with +clipboard support
alias h="history" # easily check command history

# Git aliases
alias gits="git status"
alias gitc="git commit"
alias gita="git add"
alias gitl="git log"
alias gitlo="git log --pretty=oneline"
alias gitd="git diff"

# Directory traversing aliases
alias dirs="dirs -v" # show directories with dirs
alias ..="cd .."
alias ...="cd ../.."
alias ....="cd ../../.."

## Keyboard keys
# Use caps lock as escape
setxkbmap -option "caps:escape"

##
# Ubuntu:
# enable programmable completion features (you don't need to enable
# this, if it's already enabled in /etc/bash.bashrc and /etc/profile
# sources /etc/bash.bashrc).
if ! shopt -oq posix; then
  if [ -f /usr/share/bash-completion/bash_completion ]; then
    . /usr/share/bash-completion/bash_completion
  elif [ -f /etc/bash_completion ]; then
    . /etc/bash_completion
  fi
fi

##
# Global variables
EDITOR="vim"; export EDITOR;
PS1=" \W > "

##
# My changes
if [ ! -d $HOME/.my_bin/ ]; then mkdir $HOME/.my_bin; fi # create my bin folder
export PATH=$HOME/.my_bin:$PATH # add my bin folder to PATH

# If there is a bin folder for PHPs composer add it to PATH
if [ -d $HOME/.composer/vendor/bin ]; then
    export PATH="$HOME/.composer/vendor/bin:$PATH"
fi

if [ -d $HOME/.config/composer/vendor/bin ]; then
    export PATH="$HOME/.config/composer/vendor/bin:$PATH"
fi

##
# Custom funtions

# List all custom apt repos
function list_added_apt_repos {
  for APT in `find /etc/apt/ -name \*.list`; do
      grep -o "^deb http://ppa.launchpad.net/[a-z0-9\-]\+/[a-z0-9\-]\+" $APT | while read ENTRY ; do
          USER=`echo $ENTRY | cut -d/ -f4`
          PPA=`echo $ENTRY | cut -d/ -f5`
          echo sudo apt-add-repository ppa:$USER/$PPA
      done
  done
}

# List all apt repos
function list_all_apt_repos {
  for APT in `find /etc/apt/ -name \*.list`; do
      grep -Po "(?<=^deb\s).*?(?=#|$)" $APT | while read ENTRY ; do
          HOST=`echo $ENTRY | cut -d/ -f3`
          USER=`echo $ENTRY | cut -d/ -f4`
          PPA=`echo $ENTRY | cut -d/ -f5`
          #echo sudo apt-add-repository ppa:$USER/$PPA
          if [ "ppa.launchpad.net" = "$HOST" ]; then
              echo sudo apt-add-repository ppa:$USER/$PPA
          else
              echo sudo apt-add-repository \'${ENTRY}\'
          fi
      done
  done
}

##
# Bash git prompt
if [ ! -d $HOME/.bash-git-prompt ]; then
    git clone https://github.com/magicmonty/bash-git-prompt.git ~/.bash-git-prompt --depth=1
fi
source $HOME/.bash-git-prompt/gitprompt.sh
GIT_PROMPT_ONLY_IN_REPO=1
GIT_PROMPT_FETCH_REMOTE_STATUS=0
GIT_PROMPT_START=" \W"
GIT_PROMPT_END=" > "
